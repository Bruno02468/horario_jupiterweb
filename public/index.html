<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MXWWQTC82L"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-MXWWQTC82L');
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Grade horária bonitinha">
    <meta name="author" content="Bruno Borges Paschoalinoto">
    <title>Grade horária (só que bonitinha)</title>
    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600"
    rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css"
    href="//cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="stylesheet" type="text/css"
    href="//cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"
    integrity="sha512-qoCTmFwBtCPvFhA+WAqatSOrghwpDhFHxwAGh+cppWonXbHA09nG1z5zi4/NGnp8dUhXiVrzA6EnKgJA+fyrpw=="
    crossorigin="anonymous"></script>
    <link rel="stylesheet" href="estilo.css">
  </head>
  <body>
    <div class="container center">
      <div class="row">
        <h2>Visualização de Horários do Júpiter Web</h2>
        <h6>
          Esta ferramenta besta permite criar uma versão bonitinha da sua grade
          do Júpiter Web, sabe, colorida e com links.
          <br>
        </h6>
      </div>
      <div id="no_enc" class="row">
        <div class="twelve columns">
          Para o código ter acesso ao seu horário, rode o <i>bookmarklet</i>:
          <br>
          <br>
          <ol>
            <li>
              Arraste
              <a
                onclick="return ta_na_disney();"
                title="script da grade horária"
                href="javascript:(function()%7Bfunction%20compress(e)%7Breturn%20null%3D%3De%3F%22%22%3Afunction(e%2Cr%2Ct)%7Bif(null%3D%3De)return%22%22%3Bvar%20o%2Cn%2Ca%2Ci%3D%7B%7D%2Cs%3D%7B%7D%2Cc%3D%22%22%2Cl%3D%22%22%2Cu%3D%22%22%2Cf%3D2%2Cd%3D3%2Cp%3D2%2Ch%3D%5B%5D%2Cm%3D0%2Cg%3D0%3Bfor(a%3D0%3Ba%3Ce.length%3Ba%2B%3D1)if(c%3De.charAt(a)%2CObject.prototype.hasOwnProperty.call(i%2Cc)%7C%7C(i%5Bc%5D%3Dd%2B%2B%2Cs%5Bc%5D%3D!0)%2Cl%3Du%2Bc%2CObject.prototype.hasOwnProperty.call(i%2Cl))u%3Dl%3Belse%7Bif(Object.prototype.hasOwnProperty.call(s%2Cu))%7Bif(u.charCodeAt(0)%3C256)%7Bfor(o%3D0%3Bp%3Eo%3Bo%2B%2B)m%3C%3C%3D1%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%3Bfor(n%3Du.charCodeAt(0)%2Co%3D0%3B8%3Eo%3Bo%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%7Delse%7Bfor(n%3D1%2Co%3D0%3Bp%3Eo%3Bo%2B%2B)m%3Dm%3C%3C1%7Cn%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3D0%3Bfor(n%3Du.charCodeAt(0)%2Co%3D0%3B16%3Eo%3Bo%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%7D0%3D%3D--f%26%26(f%3DMath.pow(2%2Cp)%2Cp%2B%2B)%2Cdelete%20s%5Bu%5D%7Delse%20for(n%3Di%5Bu%5D%2Co%3D0%3Bp%3Eo%3Bo%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%3B0%3D%3D--f%26%26(f%3DMath.pow(2%2Cp)%2Cp%2B%2B)%2Ci%5Bl%5D%3Dd%2B%2B%2Cu%3DString(c)%7Dif(%22%22!%3D%3Du)%7Bif(Object.prototype.hasOwnProperty.call(s%2Cu))%7Bif(u.charCodeAt(0)%3C256)%7Bfor(o%3D0%3Bp%3Eo%3Bo%2B%2B)m%3C%3C%3D1%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%3Bfor(n%3Du.charCodeAt(0)%2Co%3D0%3B8%3Eo%3Bo%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%7Delse%7Bfor(n%3D1%2Co%3D0%3Bp%3Eo%3Bo%2B%2B)m%3Dm%3C%3C1%7Cn%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3D0%3Bfor(n%3Du.charCodeAt(0)%2Co%3D0%3B16%3Eo%3Bo%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%7D0%3D%3D--f%26%26(f%3DMath.pow(2%2Cp)%2Cp%2B%2B)%2Cdelete%20s%5Bu%5D%7Delse%20for(n%3Di%5Bu%5D%2Co%3D0%3Bp%3Eo%3Bo%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%3B0%3D%3D--f%26%26(f%3DMath.pow(2%2Cp)%2Cp%2B%2B)%7Dfor(n%3D2%2Co%3D0%3Bp%3Eo%3Bo%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(t(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%3Bfor(%3B%3B)%7Bif(m%3C%3C%3D1%2Cg%3D%3Dr-1)%7Bh.push(t(m))%3Bbreak%7Dg%2B%2B%7Dreturn%20h.join(%22%22)%7D(e%2C6%2Cfunction(e)%7Breturn%22ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%2B-%24%22.charAt(e)%7D)%7Dfunction%20ensure_url(e)%7Breturn%20location.href%3D%3De%7C%7C(alert(%22Este%20script%20deve%20ser%20rodado%20na%20p%C3%A1gina%20de%20grade%20hor%C3%A1ria!%5Cn%5CnVoc%C3%AA%20ser%C3%A1%20redirecionado%20para%20l%C3%A1.%20Rode%20de%20novo%20quando%20abrir%20a%20grade...%22)%2Clocation.assign(e)%2C!1)%7Dfunction%20ensure_tables()%7Bconst%20e%3Ddocument.getElementById(%22gbox_tableGradeHoraria%22)%3Breturn%20e%7C%7C(alert(%22N%C3%A3o%20consegui%20achar%20uma%20grade%20hor%C3%A1ria%20aberta!%5Cn%5CnAbra%20uma%20e%20rode%20a%20bookmarklet%20novamente...%22)%2Cnull)%7Dfunction%20inner(e%2Cr)%7Bfor(const%20t%20of%20r)e%3De.children%5Bt%5D%3Breturn%20e%7Dfunction%20sleep(e)%7Breturn%20new%20Promise(r%3D%3EsetTimeout(r%2Ce))%7Dasync%20function%20get_deets(e%2Cr%2Ct)%7Bconst%20o%3D()%3D%3Edocument.getElementById(%22div_disciplina%22)%2Cn%3D()%3D%3Eo().getElementsByClassName(%22coddis%22)%5B0%5D.innerText%2Ca%3D()%3D%3Eo().getElementsByClassName(%22nomdis%22)%5B0%5D.innerText%3Blet%20i%3Btry%7Bi%3Dn()%7Dcatch(e)%7Bi%3Dnull%7Dfor(let%20o%3D0%3Bo%3Ct%3Bo%2B%2B)%7Be.click()%2Cawait%20sleep(r)%3Bconst%20t%3Dn()%2Co%3Da()%3Bif(t!%3Di)return%7Bcodigo%3At%2Cnome%3Ao%7D%3Bawait%20sleep(r)%7Dalert(%60Falha%20ao%20pegar%20nome%20e%20c%C3%B3digo%20da%20disciplina%20%24%7Be.innerText%7D!%60)%2Cwindow.location.reload()%7Dasync%20function%20tab2json(e%2Cr%2Ct)%7Bconst%20o%3Dinner(e%2C%5B2%2C1%2C0%2C0%2C0%2C2%5D).cells%2Cn%3DArray.from(o).map(e%3D%3Ee.innerText.trim()).slice(2)%2Ca%3Dinner(e%2C%5B2%2C2%2C0%2C1%2C0%5D)%3Blet%20i%3D%7B%7D%2Cs%3D%5B%5D%3Bfor(const%20e%20of%20a.rows)%7Bif(!e.id)continue%3Blet%20o%3Dnull%2Ca%3Dnull%2Cc%3D-2%3Bfor(const%20l%20of%20e.cells)%7Bconst%20e%3Dl.innerText.trim()%3Bif(o)if(a)%7Bif(e)%7Bconst%20e%3Dn%5Bc%5D%3Bfor(const%20n%20of%20l.children)%7Bconst%20c%3Dn.innerText.trim().substring(0%2C7)%3Bs.push(%7Bcodigo%3Ac%2Cdia%3Ae%2Cinicio%3Ao%2Cfim%3Aa%7D)%2Cc%20in%20i%7C%7C(i%5Bc%5D%3Dawait%20get_deets(n%2Cr%2Ct))%7D%7D%7Delse%20a%3De%3Belse%20o%3De%3Bc%2B%2B%7D%7Dreturn%7Baulas%3As%2Cdetalhes%3Ai%2Cver%3A1%7D%7Dfunction%20credir(e%2Cr)%7Bconst%20t%3Dr%2B%22%3Fo%3D%22%2Bcompress(JSON.stringify(e))%3Blocation.assign(t)%7Dasync%20function%20fire()%7Bif(!ensure_url(%22https%3A%2F%2Fuspdigital.usp.br%2Fjupiterweb%2FgradeHoraria%3Fcodmnu%3D4759%22))return!1%3Bconst%20e%3Densure_tables()%3Bif(!e)return!1%3Bconst%20r%3Dawait%20tab2json(e%2C1e3%2C5)%3Bif(!r)throw%22objeto%20retornou%20vazio%20(off)%22%3Bcredir(r%2C%22http%3A%2F%2Foisumida.rs%2Fhorario_jupiterweb%2F%22)%7Dfunction%20safe_main()%7Btry%7Bfire()%7Dcatch(e)%7Balert(%22Deu%20ruim!%20Repasse%20o%20seguinte%20erro%3A%5Cn%5Cn%22%2Be.message)%7D%7Dsafe_main()%7D)()">
                este link
              </a>
              para a sua <b>barra de favoritos</b>.
            </li>
            <li>
              Abra
              <a target="_blank"
              href="//uspdigital.usp.br/jupiterweb/gradeHoraria?codmnu=4759">
                a sua grade horária
              </a>
              no Júpiter Web.
            </li>
            <li>
              Clique no favorito para executar o código e aguarde.
            </li>
            <li>
              Você será redirecionado de volta para cá alguns segundos depois!
            </li>
          </ol>
          <hr>
          Se você for um nerd paranoico e não confiar em mim, pegar
          <a href="bookmarklet.js" target="_blank" title="NERD!">
            o código original do bookmarklet
          </a>
          e executar manualmente (e.g. colando no console) é sempre uma opção.
          <br>
          <br>
          <small><i>
            Para os <b>Turbo Nerds™</b>: o treco na URL é um JSON comprimido
            com
            <a href="https://github.com/pieroxy/lz-string" target="_blank">
              lz-string
            </a>
            para caber na URL (30% a 50% de compressão).
            <br>
            O <code>#fragmento</code> é a mesma coisa, mas contendo as opções.
          </i></small>
        </div>
      </div>
      <div id="has_enc">
        <div class="row">
          <b>
            Sua grade e todas as opções estão codificada no endereço da página!
          </b>
          Recomendo guardar o link.
        </div>
        <hr>
        <div class="row">
          <div class="four columns">
            <div class="formy">
              <label for="opt_prop" style="display: none !important;">
                <input type="checkbox" id="opt_prop" onchange="regen()">
                <span>Linhas proporcionais (não implementado! ignorar)</span>
              </label>
              <label for="opt_sep">
                <input type="checkbox" id="opt_sep" onchange="regen()">
                <span>Espaço entre departamento e código</span>
              </label>
              <label for="opt_evil">
                <input type="checkbox" id="opt_evil" onchange="regen()">
                <span>Usar formato de 12 horas AM/PM</span>
              </label>
              <label for="opt_nosab">
                <input type="checkbox" id="opt_nosab" onchange="regen()">
                <span>Pular sábado</span>
              </label>
              <label for="opt_shuf">
                <input type="checkbox" id="opt_shuf" onchange="regen()">
                <span>Embaralhar listras</span>
              </label>
              <label for="opt_nmvz">
                <input type="checkbox" id="opt_nmvz" onchange="regen()">
                <span>Não mesclar intervalos</span>
              </label>
              <label for="opt_nmcl">
                <input type="checkbox" id="opt_nmcl" onchange="regen()">
                <span>Não mesclar aulas</span>
              </label>
              <label for="opt_nolinks">
                <input type="checkbox" id="opt_nolinks" onchange="regen()">
                <span>Ocultar links</span>
              </label>
            </div>
          </div>
          <div class="eight columns">
            <div class="formy">
              <label for="opt_fmt">
                <span>Disciplinas:</span>
                <select id="opt_fmt" onchange="regen()">
                  <option value="C">Apenas código</option>
                  <option value="N">Apenas nome</option>
                  <option value="C-N">Código e nome</option>
                  <option value="C!n">Código em destaque e nome abaixo</option>
                  <option value="N!c">Nome em destaque e código abaixo</option>
                </select>
              </label>
              <label for="opt_fday">
                <span>Nomes dos dias da semana:</span>
                <select id="opt_fday" onchange="regen()">
                  <option value="letra">Letras (terça = "T")</option>
                  <option value="abreviado">Abreviados (terça = "Ter")</option>
                  <option value="coloquial" selected>
                    Coloquiais (terça = "terça")
                  </option>
                  <option value="completo">
                    Completos (terça = "terça-feira")
                  </option>
                </select>
              </label>
              <label for="opt_cmix">
                <span>Estratégia para cores em conflitos:</span>
                <select id="opt_cmix" onchange="regen()">
                  <option value="stripes">Listras</option>
                  <option value="blend">Misturar</option>
                </select>
              </label>
              <label for="opt_stra">
                <span>Ângulo das listras:</span>
                <input type="range" min="0" max="360" step="1" id="opt_stra"
                onchange="regen()" oninput="regen()" value="45">
              </label>
              <label for="opt_strw">
                <span>Largura das listas:</span>
                <input type="range" min="0" max="4" step="0.25" id="opt_strw"
                onchange="regen()" oninput="regen()">
              </label>
              <label for="opt_alpha">
                <span>Alfa (para mistura de cores):</span>
                <input type="range" min="0" max="1" step="0.05" id="opt_alpha"
                onchange="regen()" oninput="regen()" value="1">
              </label>
              <label for="opt_borr">
                <span>Bordas redondas:</span>
                <input type="range" min="0" max="5" step="0.1" id="opt_borr"
                onchange="regen()" oninput="regen()" value="0">
              </label>
            </div>
          </div>
        </div>
        <hr>
        <br>
        <div class="row btns">
          <div class="four columns">
            <button onclick="edit()">Editar horário e aulas</button>
          </div>
          <div class="four columns">
            <button class="button-primary" onclick="imprimir()">
              Link printável/compartilhável
            </button>
          </div>
          <div class="four columns">
            <button onclick="window.location.assign('./')">
              Apagar grade (pense bem)
            </button>
          </div>
        </div>
        <br>
        Preview:
        <br>
        <br>
        <div class="row">
          <div class="twelve columns">
            <table id="mt">
              <thead id="mh"></thead>
              <tbody id="mb"></tbody>
            </table>
          </div>
        </div>
        <hr>
        Editar disciplinas:
        <br>
        <br>
        <div class="row btns">
          <div class="four columns">
            <button onclick="color_shuffle()">Reordenar cores</button>
          </div>
          <div class="four columns">
            <button onclick="color_default()">Randomizar cores</button>
          </div>
          <div class="four columns">
            <button onclick="renomes()">Resetar nomes</button>
          </div>
        </div>
        <br>
        <div class="row" id="incolors">
          <div class="four columns"></div>
          <div class="four columns"></div>
          <div class="four columns"></div>
        </div>
        <div class="row">
          <div class="twelve columns">
            <i>
              Dica: clique numa disciplina para mudar seu nome!<br>
              Por enquanto, essa alteração não é salva no endereço.<br>
              Se fizer besteira, só recarregar ou clicar em "resetar nomes".
            </i>
          </div>
        </div>
        <br>
      </div>
      <br>
      <hr>
      <div class="row">
        <div class="twelve columns">
          <i>
            Se encontrar qualquer problema ou bug, <b>reporte</b> para
            <a href="mailto:bruno@oisumida.rs">bruno@oisumida.rs</a>
            ou via issue no GitHub.
            <br>
            Se você estiver interessado no código, ele está num
            <a href="https://github.com/Bruno02468/horario_jupiterweb"
            target="_blank">repositório do GitHub</a>!
            <br>
            <br>
            © 2021
            <a href="//bor.gs" target="_blank">Bruno Borges Paschoalinoto</a>
            <br>
            Nenhum direito reservado: este software está no
            <a href="//unlicense.org">domínio público</a>!
          </i>
          <br>
          <br>
        </div>
      </div>
    </div>
    <script src="geral.js"></script>
    <script src="view.js"></script>
    <script>
      kickstart();
    </script>
  </body>
</html>
