<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MXWWQTC82L"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-MXWWQTC82L');
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Grade horária bonitinha">
    <meta name="author" content="Bruno Borges Paschoalinoto">
    <title>Grade horária (só que bonitinha)</title>
    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600"
    rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css"
    href="//cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="stylesheet" type="text/css"
    href="//cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"
    integrity="sha512-qoCTmFwBtCPvFhA+WAqatSOrghwpDhFHxwAGh+cppWonXbHA09nG1z5zi4/NGnp8dUhXiVrzA6EnKgJA+fyrpw=="
    crossorigin="anonymous"></script>
    <link rel="stylesheet" href="estilo.css">
  </head>
  <body>
    <div class="container center">
      <div class="row">
        <h2>Visualização de Horários do Júpiter Web</h2>
        <h6>
          Ferramenta besta que eu fiz pra gerar versões bonitinhas e
          proporcionais da minha grade horária -- primariamente para imprimir
          e botar na geladeira.
          <br>
        </h6>
      </div>
      <div id="no_enc" class="row">
        <div class="twelve columns">
          Para o código ter acesso ao seu horário, você precisa abrir
          <a
            target="_blank"
            href="//uspdigital.usp.br/jupiterweb/gradeHoraria?codmnu=4759"
          >
            a sua grade horária no Júpiter Web
          </a>
          e rodar um pequeno código que vai pegar sua grade, os detalhes das
          disciplinas, e redirecionar para cá.
          <br>
          <br>
          O jeito mais fácil é rodando um <i>bookmarklet</i>: coloque
          <a
            onclick="return false;"
            href="javascript:(function()%7Bconst%20_compress%3Dfunction(e%2Cr%2Co)%7Bif(null%3D%3De)return%22%22%3Bvar%20t%2Cn%2Cs%2Ci%3D%7B%7D%2Ca%3D%7B%7D%2Cc%3D%22%22%2Cu%3D%22%22%2Cl%3D%22%22%2Cf%3D2%2Cp%3D3%2Cd%3D2%2Ch%3D%5B%5D%2Cm%3D0%2Cg%3D0%3Bfor(s%3D0%3Bs%3Ce.length%3Bs%2B%3D1)if(c%3De.charAt(s)%2CObject.prototype.hasOwnProperty.call(i%2Cc)%7C%7C(i%5Bc%5D%3Dp%2B%2B%2Ca%5Bc%5D%3D!0)%2Cu%3Dl%2Bc%2CObject.prototype.hasOwnProperty.call(i%2Cu))l%3Du%3Belse%7Bif(Object.prototype.hasOwnProperty.call(a%2Cl))%7Bif(l.charCodeAt(0)%3C256)%7Bfor(t%3D0%3Bd%3Et%3Bt%2B%2B)m%3C%3C%3D1%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%3Bfor(n%3Dl.charCodeAt(0)%2Ct%3D0%3B8%3Et%3Bt%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%7Delse%7Bfor(n%3D1%2Ct%3D0%3Bd%3Et%3Bt%2B%2B)m%3Dm%3C%3C1%7Cn%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3D0%3Bfor(n%3Dl.charCodeAt(0)%2Ct%3D0%3B16%3Et%3Bt%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%7D0%3D%3D--f%26%26(f%3DMath.pow(2%2Cd)%2Cd%2B%2B)%2Cdelete%20a%5Bl%5D%7Delse%20for(n%3Di%5Bl%5D%2Ct%3D0%3Bd%3Et%3Bt%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%3B0%3D%3D--f%26%26(f%3DMath.pow(2%2Cd)%2Cd%2B%2B)%2Ci%5Bu%5D%3Dp%2B%2B%2Cl%3DString(c)%7Dif(%22%22!%3D%3Dl)%7Bif(Object.prototype.hasOwnProperty.call(a%2Cl))%7Bif(l.charCodeAt(0)%3C256)%7Bfor(t%3D0%3Bd%3Et%3Bt%2B%2B)m%3C%3C%3D1%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%3Bfor(n%3Dl.charCodeAt(0)%2Ct%3D0%3B8%3Et%3Bt%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%7Delse%7Bfor(n%3D1%2Ct%3D0%3Bd%3Et%3Bt%2B%2B)m%3Dm%3C%3C1%7Cn%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3D0%3Bfor(n%3Dl.charCodeAt(0)%2Ct%3D0%3B16%3Et%3Bt%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%7D0%3D%3D--f%26%26(f%3DMath.pow(2%2Cd)%2Cd%2B%2B)%2Cdelete%20a%5Bl%5D%7Delse%20for(n%3Di%5Bl%5D%2Ct%3D0%3Bd%3Et%3Bt%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%3B0%3D%3D--f%26%26(f%3DMath.pow(2%2Cd)%2Cd%2B%2B)%7Dfor(n%3D2%2Ct%3D0%3Bd%3Et%3Bt%2B%2B)m%3Dm%3C%3C1%7C1%26n%2Cg%3D%3Dr-1%3F(g%3D0%2Ch.push(o(m))%2Cm%3D0)%3Ag%2B%2B%2Cn%3E%3E%3D1%3Bfor(%3B%3B)%7Bif(m%3C%3C%3D1%2Cg%3D%3Dr-1)%7Bh.push(o(m))%3Bbreak%7Dg%2B%2B%7Dreturn%20h.join(%22%22)%7D%2Ce%3D%22ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%2B-%24%22%3Bfunction%20compress(r)%7Breturn%20null%3D%3Dr%3F%22%22%3A_compress(r%2C6%2Cfunction(r)%7Breturn%20e.charAt(r)%7D)%7Dfunction%20ensure_url(e)%7Breturn%20location.href%3D%3De%7C%7C(alert(%22Este%20script%20deve%20ser%20rodado%20na%20p%C3%A1gina%20de%20grade%20hor%C3%A1ria!%5Cn%5CnVoc%C3%AA%20ser%C3%A1%20redirecionado%20para%20l%C3%A1.%20Rode%20de%20novo%20quando%20abrir%20a%20grade...%22)%2Clocation.assign(e)%2C!1)%7Dfunction%20ensure_tables()%7Bconst%20e%3Ddocument.getElementById(%22gbox_tableGradeHoraria%22)%3Breturn%20e%7C%7C(alert(%22N%C3%A3o%20consegui%20achar%20uma%20grade%20hor%C3%A1ria%20aberta!%5Cn%5CnAbra%20uma%20e%20rode%20a%20bookmarklet%20novamente...%22)%2Cnull)%7Dfunction%20inner(e%2Cr)%7Bfor(const%20o%20of%20r)e%3De.children%5Bo%5D%3Breturn%20e%7Dfunction%20sleep(e)%7Breturn%20new%20Promise(r%3D%3EsetTimeout(r%2Ce))%7Dfunction%20get_deets()%7Bconst%20e%3Ddocument.getElementById(%22div_disciplina%22)%3Breturn%7Bcodigo%3Ae.getElementsByClassName(%22coddis%22)%5B0%5D.innerText%2Cnome%3Ae.getElementsByClassName(%22nomdis%22)%5B0%5D.innerText%7D%7Dasync%20function%20tab2json(e%2Cr)%7Bconst%20o%3Dinner(e%2C%5B2%2C1%2C0%2C0%2C0%2C2%5D).cells%2Ct%3DArray.from(o).map(e%3D%3Ee.innerText.trim()).slice(2)%2Cn%3Dinner(e%2C%5B2%2C2%2C0%2C1%2C0%5D)%3Blet%20s%3D%7B%7D%2Ci%3D%5B%5D%3Bfor(const%20e%20of%20n.rows)%7Bif(!e.id)continue%3Blet%20o%3Dnull%2Cn%3Dnull%2Ca%3D-2%3Bfor(const%20c%20of%20e.cells)%7Bconst%20e%3Dc.innerText.trim()%3Bif(o)if(n)%7Bif(e)%7Bconst%20e%3Dt%5Ba%5D%3Bfor(const%20t%20of%20c.children)%7Bconst%20a%3Dt.innerText.trim().substring(0%2C7)%3Bi.push(%7Bcodigo%3Aa%2Cdia%3Ae%2Cinicio%3Ao%2Cfim%3An%7D)%2Ca%20in%20s%7C%7C(t.click()%2Cawait%20sleep(r)%2Cs%5Ba%5D%3Dget_deets()%2Cawait%20sleep(r%2F2))%7D%7D%7Delse%20n%3De%3Belse%20o%3De%3Ba%2B%2B%7D%7Dreturn%7Baulas%3Ai%2Cdetalhes%3As%2Cver%3A1%7D%7Dfunction%20credir(e%2Cr)%7Bconst%20o%3Dr%2B%22%3Fo%3D%22%2Bcompress(JSON.stringify(e))%3Blocation.assign(o)%7Dasync%20function%20fire()%7Bif(!ensure_url(%22https%3A%2F%2Fuspdigital.usp.br%2Fjupiterweb%2FgradeHoraria%3Fcodmnu%3D4759%22))return!1%3Bconst%20e%3Densure_tables()%3Bif(!e)return!1%3Bconst%20r%3Dawait%20tab2json(e%2C1e3)%3Bif(!r)throw%22objeto%20retornou%20vazio%20(off)%22%3Bcredir(r%2C%22http%3A%2F%2Fsegredos.oisumida.rs%2Fhorario_jupiterweb%2F%22)%7Dfunction%20safe_main()%7Btry%7Bfire()%7Dcatch(e)%7Balert(%22Deu%20ruim!%20Repasse%20o%20seguinte%20erro%3A%5Cn%5Cn%22%2Be.message)%7D%7Dsafe_main()%7D)()">
            este link
          </a>
          nos seus favoritos, abra sua grade horária, e abra o favorito para
          executar o código.
          <br>
          <hr>
          Se você não confia em mim , você pode ver
          <a href="bookmarklet.js">
            o código original
          </a>
          e executar manualmente (e.g. colando no console).
          <br>
          <br>
          Alguns segundos depois, você será redirecionado de volta pra cá, mas
          com um treco gigante no endereço, contendo sua grade, aí você vai
          poder editar a aparência etc. e imprimir se quiser.
          <br>
          <br>
          <i>
            Para os nerds: o treco na URL é um JSON comprimido usando
            <a href="https://github.com/pieroxy/lz-string" target="_blank">
              lz-string
            </a>
            para caber na URL (comprime pra 2/3 do tamanho original).
          </i>
        </div>
      </div>
      <div id="has_enc">
        <div class="row">
          <b>Sua grade está codificada no endereço da página</b>, então guarde
          o link se quiser economizar tempo!
        </div>
        <hr>
        <div class="row">
          <div class="six columns left">
            <label for="opt_prop">
              <input type="checkbox" id="opt_prop" onchange="regen()">
              Linhas de altura proporcional à duração
            </label>
            <label for="opt_sep">
              <input type="checkbox" id="opt_sep" onchange="regen()">
              Espaço entre departamento e código
            </label>
            <label for="opt_evil">
              <input type="checkbox" id="opt_evil" onchange="regen()">
              Usar formato de 12 horas AM/PM
            </label>
            <label for="opt_nosab">
              <input type="checkbox" id="opt_nosab" onchange="regen()">
              Pular sábado
            </label>
          </div>
          <div class="six columns right">
            Disciplinas:
            <select id="opt_fmt" onchange="regen()">
              <option value="C">Apenas código</option>
              <option value="N">Apenas nome</option>
              <option value="CN">Código e nome</option>
              <option value="C!n">Código em destaque e nome abaixo</option>
              <option value="N!c">Nome em destaque e código abaixo</option>
            </select>
            <br>
            Nomes dos dias da semana:
            <select id="opt_fday" onchange="regen()">
              <option value="letra">Letras (terça = "T")</option>
              <option value="abreviado">Abreviados (terça = "Ter")</option>
              <option value="coloquial" selected>
                Coloquiais (terça = "terça")
              </option>
              <option value="completo">
                Completos (terça = "terça-feira")
              </option>
            </select>
            <br>
            Estratégia para cores em conflitos:
            <select id="opt_cmix" onchange="regen()">
              <option value="blend">Misturar</option>
              <option value="stripes">Listras</option>
            </select>
            <br>
            <label for="opt_stra">
              <input type="range" min="0" max="360" step="1" id="opt_stra"
              onchange="regen()" value="45">
              Ângulo das listras
            </label>
            <label for="opt_strw">
              <input type="range" min="0" max="4" step="0.25" id="opt_strw"
              onchange="regen()">
              Largura das listas
            </label>
            <label for="opt_strw">
              <input type="range" min="0" max="1" step="0.05" id="opt_alpha"
              onchange="regen()">
              Força de mistura de cores
            </label>
          </div>
        </div>
        <hr>
        <div class="row">
          <div class="twelve columns">
            Nomes e cores das disciplinas:
          </div>
        </div>
        <br>
        <div class="row">
          <div class="four columns">
            <button onclick="color_shuffle()">Randomizar ordem</button>
          </div>
          <div class="four columns">
            <button onclick="color_default()">Randomizar cores</button>
          </div>
          <div class="four columns">
            <button onclick="window.location.reload()">Resetar</button>
          </div>
        </div>
        <br>
        <div class="row" id="incolors">
          <div class="four columns"></div>
          <div class="four columns"></div>
          <div class="four columns"></div>
        </div>
        <hr>
        <div class="row">
          <div class="twelve columns">
            <table id="mt">
              <thead id="mh"></thead>
              <tbody id="mb"></tbody>
            </table>
          </div>
        </div>
        <br>
      </div>
      <br>
      <hr>
      <div class="row">
        <div class="twelve columns">
          <i>
            Se encontrar qualquer problema ou bug, <b>reporte</b> para
            <a href="mailto:bruno@oisumida.rs">bruno@oisumida.rs</a>
            ou via issue no GitHub.
            <br>
            Se você estiver interessado no código, ele está num
            <a href="https://github.com/Bruno02468/horario_jupiterweb"
            target="_blank">repositório do GitHub</a>!
            <br>
            <br>
            © 2021
            <a href="//bor.gs" target="_blank">Bruno Borges Paschoalinoto</a>
            <br>
            Nenhum direito reservado: este software está no
            <a href="//unlicense.org">domínio público</a>!
          </i>
          <br>
          <br>
        </div>
      </div>
    </div>
    <script src="bor.js"></script>
  </body>
</html>
